<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Theis Drawdown</title>
    <style>
      html, body {
        box-sizing: border-box;
        display: flow-root;
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-3.4.1.min.js"></script>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.4.1.min.js"></script>
    <script type="text/javascript">
        Bokeh.set_log_level("info");
    </script>
  </head>
  <body>
    <div id="ff4cdbcd-8b9e-4ef9-b481-c49bff8750f4" data-root-id="p3125" style="display: contents;"></div>
  
    <script type="application/json" id="d3e9593e-2948-45ba-8b8d-6d33d137d123">
      {"24cd248f-8966-43c0-8783-b5a8e2f0b35e":{"version":"3.4.1","title":"Bokeh Application","roots":[{"type":"object","name":"Column","id":"p3125","attributes":{"children":[{"type":"object","name":"Slider","id":"p3054","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"type":"object","name":"CustomJS","id":"p3124","attributes":{"args":{"type":"map","entries":[["src_dict",{"type":"map","entries":[["EarlyT",{"type":"object","name":"ColumnDataSource","id":"p3097","attributes":{"selected":{"type":"object","name":"Selection","id":"p3098","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p3099"},"data":{"type":"map","entries":[["dd",[]],["t",[]]]}}}],["LateT",{"type":"object","name":"ColumnDataSource","id":"p3100","attributes":{"selected":{"type":"object","name":"Selection","id":"p3101","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p3102"},"data":{"type":"map","entries":[["dd",[]],["t",[]]]}}}]]}],["sl_dict",{"type":"map","entries":[["Q",{"id":"p3054"}],["R",{"type":"object","name":"Slider","id":"p3055","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p3124"}]]]},"stylesheets":[{"type":"object","name":"InlineStyleSheet","id":"p3053","attributes":{"css":"div.bk-slider-title{\n                font-family: arial;\n                font-weight: bold;\n                font-size: 14pt;\n                color: #17648D;\n"}}],"width":800,"title":"Radius from Well (m)","start":1,"end":1000,"value":1}}],["b",{"type":"object","name":"Slider","id":"p3056","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p3124"}]]]},"stylesheets":[{"id":"p3053"}],"width":800,"title":"Aquifer thickness (m)","format":"0.00","start":1,"end":100,"value":20,"step":0.01}}],["T",{"type":"object","name":"Slider","id":"p3058","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p3124"}]]]},"stylesheets":[{"id":"p3053"}],"width":800,"title":"Aquifer Transmissivity (m\u00b2/s)","format":{"type":"object","name":"CustomJSTickFormatter","id":"p3057","attributes":{"code":"return (10**tick).toExponential(2).toString()"}},"start":-7,"end":0,"value":-2,"step":0.1}}],["Ss",{"type":"object","name":"Slider","id":"p3060","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p3124"}]]]},"stylesheets":[{"id":"p3053"}],"width":800,"title":"Specific Storage (1/m)","format":{"type":"object","name":"CustomJSTickFormatter","id":"p3059","attributes":{"code":"return (10**tick).toExponential(2).toString()"}},"start":-7,"end":0,"value":-4,"step":0.1}}],["Sy",{"type":"object","name":"Slider","id":"p3061","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p3124"}]]]},"stylesheets":[{"id":"p3053"}],"width":800,"title":"Specific Yield (dimensionless)","start":0.01,"end":0.5,"value":0.2,"step":0.01}}]]}],["f",{"type":"object","name":"Figure","id":"p3062","attributes":{"width":800,"height":800,"x_range":{"type":"object","name":"Range1d","id":"p3072","attributes":{"start":1,"end":10000000.0}},"y_range":{"type":"object","name":"Range1d","id":"p3073","attributes":{"start":0.01,"end":10}},"x_scale":{"type":"object","name":"LogScale","id":"p3074"},"y_scale":{"type":"object","name":"LogScale","id":"p3075"},"title":{"type":"object","name":"Title","id":"p3065","attributes":{"text":"Neuman drawdown","text_color":"#17648D","text_font":"arial","text_font_size":"16pt"}},"renderers":[{"type":"object","name":"GlyphRenderer","id":"p3109","attributes":{"data_source":{"id":"p3097"},"view":{"type":"object","name":"CDSView","id":"p3110","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p3111"}}},"glyph":{"type":"object","name":"Line","id":"p3106","attributes":{"x":{"type":"field","field":"t"},"y":{"type":"field","field":"dd"},"line_color":"blue"}},"nonselection_glyph":{"type":"object","name":"Line","id":"p3107","attributes":{"x":{"type":"field","field":"t"},"y":{"type":"field","field":"dd"},"line_color":"blue","line_alpha":0.1}},"muted_glyph":{"type":"object","name":"Line","id":"p3108","attributes":{"x":{"type":"field","field":"t"},"y":{"type":"field","field":"dd"},"line_color":"blue","line_alpha":0.2}}}},{"type":"object","name":"GlyphRenderer","id":"p3120","attributes":{"data_source":{"id":"p3100"},"view":{"type":"object","name":"CDSView","id":"p3121","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p3122"}}},"glyph":{"type":"object","name":"Line","id":"p3117","attributes":{"x":{"type":"field","field":"t"},"y":{"type":"field","field":"dd"},"line_color":"orange"}},"nonselection_glyph":{"type":"object","name":"Line","id":"p3118","attributes":{"x":{"type":"field","field":"t"},"y":{"type":"field","field":"dd"},"line_color":"orange","line_alpha":0.1}},"muted_glyph":{"type":"object","name":"Line","id":"p3119","attributes":{"x":{"type":"field","field":"t"},"y":{"type":"field","field":"dd"},"line_color":"orange","line_alpha":0.2}}}}],"toolbar":{"type":"object","name":"Toolbar","id":"p3071","attributes":{"tools":[{"type":"object","name":"PanTool","id":"p3086"},{"type":"object","name":"WheelZoomTool","id":"p3087","attributes":{"renderers":"auto"}},{"type":"object","name":"BoxZoomTool","id":"p3088","attributes":{"overlay":{"type":"object","name":"BoxAnnotation","id":"p3089","attributes":{"syncable":false,"level":"overlay","visible":false,"left":{"type":"number","value":"nan"},"right":{"type":"number","value":"nan"},"top":{"type":"number","value":"nan"},"bottom":{"type":"number","value":"nan"},"left_units":"canvas","right_units":"canvas","top_units":"canvas","bottom_units":"canvas","line_color":"black","line_alpha":1.0,"line_width":2,"line_dash":[4,4],"fill_color":"lightgrey","fill_alpha":0.5}}}},{"type":"object","name":"SaveTool","id":"p3094"},{"type":"object","name":"ResetTool","id":"p3095"},{"type":"object","name":"HelpTool","id":"p3096"}]}},"left":[{"type":"object","name":"LogAxis","id":"p3081","attributes":{"ticker":{"type":"object","name":"LogTicker","id":"p3082","attributes":{"num_minor_ticks":10,"mantissas":[1,5]}},"formatter":{"type":"object","name":"LogTickFormatter","id":"p3083"},"axis_label":"Drawdown (m)","axis_label_text_color":"#17648D","axis_label_text_font":"arial","axis_label_text_font_size":"14pt","axis_label_text_font_style":"bold","major_label_policy":{"type":"object","name":"AllLabels","id":"p3084"},"major_label_text_font":"arial","major_label_text_font_size":"12pt","major_label_text_font_style":"normal"}}],"below":[{"type":"object","name":"LogAxis","id":"p3076","attributes":{"ticker":{"type":"object","name":"LogTicker","id":"p3077","attributes":{"num_minor_ticks":10,"mantissas":[1,5]}},"formatter":{"type":"object","name":"LogTickFormatter","id":"p3078"},"axis_label":"Time (s)","axis_label_text_color":"#17648D","axis_label_text_font":"arial","axis_label_text_font_size":"14pt","axis_label_text_font_style":"bold","major_label_policy":{"type":"object","name":"AllLabels","id":"p3079"},"major_label_text_font":"arial","major_label_text_font_size":"12pt","major_label_text_font_style":"normal"}}],"center":[{"type":"object","name":"Grid","id":"p3080","attributes":{"axis":{"id":"p3076"}}},{"type":"object","name":"Grid","id":"p3085","attributes":{"dimension":1,"axis":{"id":"p3081"}}},{"type":"object","name":"Legend","id":"p3112","attributes":{"title_text_font":"arial","title_text_font_size":"14pt","title_text_font_style":"bold","label_text_color":"#17648D","label_text_font":"arial","label_text_font_size":"12pt","items":[{"type":"object","name":"LegendItem","id":"p3113","attributes":{"label":{"type":"value","value":"Computed drawdown by early Theis"},"renderers":[{"id":"p3109"}]}},{"type":"object","name":"LegendItem","id":"p3123","attributes":{"label":{"type":"value","value":"Computed drawdown by late Theis"},"renderers":[{"id":"p3120"}]}}]}}]}}]]},"code":"// js function equivalent to np.linspace\nfunction makeArr(startValue, stopValue, cardinality) {\n  var arr = [];\n  var step = (stopValue - startValue) / (cardinality - 1);\n  for (var i = 0; i &lt; cardinality; i++) {\n\tarr.push(startValue + (step * i));\n  }\n  return arr;\n}\n\nimport * as d3 from \"https://cdn.jsdelivr.net/npm/d3@7.9/+esm\"\nimport cephes from 'https://cdn.jsdelivr.net/npm/cephes@2.0.0/+esm'\nawait cephes.compiled\n\nexport default function({src_dict,sl_dict,f}){\n\t//collect slider values\n\tvar q = sl_dict['Q'].value\n\tvar tr = 10**sl_dict['T'].value\n\tvar b = sl_dict['b'].value\n\tvar r = sl_dict['R'].value\n\tvar ss = 10**sl_dict['Ss'].value\n\tvar sy = sl_dict['Sy'].value\n\t\n    //evaluate well function at 100 points along 1e-5 and 1e4 seconds\n\tvar w_u = makeArr(-5,4,100).map(x=&gt;cephes.expn(1,10**x))\n\t// same points, get inverse\n\tvar u_inv = makeArr(-5,4,100).map(x=&gt;1/10**x)\n\t//early curve term\n    var t_a_term = r**2 * ss * b / 4 / tr\n    console.log(ss)\n    //late curve term\n    var t_b_term = r**2 * sy / 4 / tr\n    \n    var s_term = q/(4*Math.PI*tr)\n    \n    var t_a = u_inv.map(x=&gt;x*t_a_term)\n    var t_b = u_inv.map(x=&gt;x*t_b_term)\n    var s = w_u.map(x=&gt;x*s_term &lt; 1e-2 ? 'nan' : x*s_term)\n    \n    //update the theis datasources\n    src_dict['EarlyT'].data={'t':t_a,'dd':s}\n    src_dict['LateT'].data={'t':t_b,'dd':s}\n    f.y_range.start = 0.01\n    f.y_range.end = d3.max(s)*10\n    f.x_range.start = 1\n    f.x_range.end = d3.max(t_a)*10\n    \n    \n}","module":true}}]]]},"stylesheets":[{"id":"p3053"}],"width":800,"title":"Pumping rate (m\u00b3/s)","format":"0.000","start":0,"end":0.2,"value":0,"step":0.001}},{"id":"p3055"},{"id":"p3056"},{"id":"p3058"},{"id":"p3060"},{"id":"p3061"},{"id":"p3062"}]}}]}}
    </script>
    <script type="text/javascript">
      (function() {
        const fn = function() {
          Bokeh.safely(function() {
            (function(root) {
              function embed_document(root) {
              const docs_json = document.getElementById('d3e9593e-2948-45ba-8b8d-6d33d137d123').textContent;
              const render_items = [{"docid":"24cd248f-8966-43c0-8783-b5a8e2f0b35e","roots":{"p3125":"ff4cdbcd-8b9e-4ef9-b481-c49bff8750f4"},"root_ids":["p3125"]}];
              root.Bokeh.embed.embed_items(docs_json, render_items);
              }
              if (root.Bokeh !== undefined) {
                embed_document(root);
              } else {
                let attempts = 0;
                const timer = setInterval(function(root) {
                  if (root.Bokeh !== undefined) {
                    clearInterval(timer);
                    embed_document(root);
                  } else {
                    attempts++;
                    if (attempts > 100) {
                      clearInterval(timer);
                      console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                    }
                  }
                }, 10, root)
              }
            })(window);
          });
        };
        if (document.readyState != "loading") fn();
        else document.addEventListener("DOMContentLoaded", fn);
      })();
    </script>
  </body>
</html>